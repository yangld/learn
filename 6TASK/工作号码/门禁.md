## 序列图
![[Sequence Diagram1 3.jpg]]
## ER图
```mermaid
erDiagram
	MdmPolicyTemplate		||--|{ 	MdmDeviceInfo	: one-to-many
	MdmDeviceInfo			||--|{ 	MdmUser			: many-to-one
	MdmUser					||--|{ 	EntranceGuardCard	: one-to-many
	MdmUser					||--|{ 	EntranceGuardCardTotal: one-to-many
	EntranceGuardCard		||--|{ 	EntranceGuardCardTotal: one-to-one
	
	MdmPolicyTemplate		||--|{ EntranceGuardPolicy: one-to-many
	EntranceGuardPolicy		}|--|| EntranceGuard	: many-to-one
	
	MdmPolicyTemplate {
		string controlGroupId
		string policyTemplateId
		string id
	}

	EntranceGuardPolicy {
	    string entranceGuardId
	    string policyId
        string policyGroupId
		string id
    }

	EntranceGuard {
	    string name
		string location
		string inTag
		string outTag
		string tel
    }
	
	EntranceGuardCard {
	    string userId
		string cardType
		string cardName
		string cardId
		string id
    }
	
	EntranceLog {
		string deviceUuid
		string account
		string entranceGuardId
		string action
		string name
		string orgname
		string deviceName
		string entranceGuardName
		string entranceGuardLocation
		string policyResult
		string actionTime
		string entranceGuardCardId
	}
	
```

## 新增功能
1. 新增功能，共23个功能
	1. 门禁
		1. 列表，添加，编辑，删除，明细
		2. 名称，位置，进门标签，出门标签， 所属机构，添加时间，更新时间，更新人
		3. 发送策略变更命令-------
	2. 门禁卡
		1. 列表，添加，编辑，删除，明细，导入检查，导入
		2. 用户id，门禁卡类型，卡名称，卡id，添加时间，更新时间，更新人
		3. 视图，与用户表关联，增加用户名，姓名，所属机构
		4. 发送门禁卡变更命令
		5. 设备端获取门禁卡列表
	3. 策略
		1. NFC围栏策略， 增加门禁设置
		2. 电子围栏策略，增加门禁设置
	4. 操作日志
		1. 门禁，门禁卡
	5. 门禁日志
		1. 姓名，用户名，所属机构， 设备名，动作，门禁，门禁位置，策略切换结果，门禁卡ID，时间
		2. 设备端上报门禁出入日志-------
		3. 门禁系统上报门禁进出日志
		4. 下发门禁进出命令
	6. 权限管理-------
2. 计划：开发时间共5天
	1. 编写web端新接口，共12个接口， 支持门禁和门禁卡的接口：1天
	2. 修改plist，支持nfc围栏和电子围栏支持门禁设置
	3. 增加门禁信息变更的命令
	4. 增加获取门禁信息的接口
	5. 增加门禁卡信息变更的命令
	6. 增加获取门禁卡信息的接口
	7. 门禁进出日志
	8. 门禁功能开发：1天
	9. 门禁卡功能开发：1天
	10. 增加菜单和按钮相关权限：1天
	11. 设备相关命令和接口：1天
3. 疑问
	1. 


