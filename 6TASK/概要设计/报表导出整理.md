	统计有哪些系统        
		mdm，app， cds， exp
	哪些系统有哪些报表导出  
		mdm/安全审计，/统计报表；app/部署统计，/运行统计，/活跃用户；cds/监控管理
	
	报表导出的方式是什么
		直接返回生成的文件
		写入mysql，在下载菜单中展示
	
	输入：现有的系统，现有的代码
	
	输出：系统，导出名称，导出描述，导出方式
	输出：通用导出模型设计文档


终端安全管理   jasper   poi
1. 安全审计
	1. 安卓应用安装导出report/audit_export    REPORT_TYPE_ANDROID_DEVICE_INSTALL_APP
		1. 配置参数
		2. 创建任务
		3. 执行任务
			1. 根据reportType构造导出文件名称
			2. 创建任务对象
			3. 执行导出
				1. 根据reportType执行不同的逻辑
				2. 构造查询参数
				3. 查询设备安装记录
				4. 构造JRDataSource
				5. 导出数据或导出空文件
			4. 设置状态并保存任务对象
	2. 苹果应用安装导出report/audit_export     REPORT_TYPE_IOS_DEVICE_INSTALL_APP
	3. 应用使用导出report/audit_export    REPORT_TYPE_APP_AUDIT
		1.  配置参数
		2. 创建任务
		3. 执行任务
			1. 根据reportType构造导出文件名称
			2. 创建任务对象
			3. 执行导出
				1. 根据reportType执行不同的逻辑
				3. 查询es数据
				4. 构造JRDataSource
				5. 导出数据或导出空文件
			4. 设置状态并保存任务对象
	4. 上网行为导出report/audit_export
		1. 过程同应用使用导出
	5. 通话记录导出     report/app_audit_export
		1. 导出通话记录  report/app_audit_export
			1.  配置参数
			2. 创建任务
			3. 执行任务
				1. 根据reportType构造导出文件名称
				2. 创建任务对象
				3. 执行导出
					1. 根据reportType执行不同的逻辑
					3. 查询es数据
					4. 构造JRDataSource
					5. 导出数据或导出空文件
				4. 设置状态并保存任务对象
		2. 导出通话录音 report/app_audit_export
			1. 过程同导出通话记录
	6. 短信记录导出report/audit_export
		1. 过程同应用使用导出
	7. 彩信记录导出   web端导出有问题
		1. 过程同应用使用导出
	8. 微信聊天导出 report/app_audit_export
		1. 微信聊天列表导出report/app_audit_export
			1. 过程同QQ聊天明细导出
		2. 微信聊天明细导出report/app_audit_export
			1. 过程同QQ聊天明细导出
	9. QQ聊天导出  web端导出有问题
		1. QQ聊天列表导出   web端导出有问题
			1. 过程同QQ聊天明细导出
		2. QQ聊天明细导出report/app_audit_export
			1.  配置参数
			2. 创建任务
			3. 执行任务
				1. 根据reportType构造导出文件名称
				2. 创建任务对象
				3. 执行导出
					1. 根据reportType执行不同的逻辑
					2. 根据参数获取数据并构造JRDataSource
					3. 导出数据或导出空文件
				4. 设置状态并保存任务对象
	10. 敏感词导出  web端导出有问题
		1. 过程同应用使用导出
	11. 违规状态记录导出 report/audit_export
		1. 过程同应用使用导出
2. 统计报表
	1. 用户统计导出
		1. 用户统计导出 report/export_users  
			1. 同上
		2. 用户活跃导出 expanded/active_data/user/active/export    poi
			1. 构造参数
			2. 创建任务对象
				3. 执行导出
					1. 使用poi的方式填充文件的单元格信息
					2. 导出数据或导出空文件
			3. 设置状态并保存任务对象
		3. 单用户使用趋势导出 expanded/active_data/user/8b2127006e894f5d8f7adea242c8ae09/trend/export
			1. 同 用户活跃导出
		4. 单用户应用使用对比导出expanded/active_data/user/8b2127006e894f5d8f7adea242c8ae09/app/compare/export
			1. 同用户活跃导出
		5. 机构活跃导出expanded/active_data/org/active/export
			1. 用户活跃导出
	2. 设备统计导出report/export_devices
		1. 同上
	3. 安全统计导出report/export_devices
		1. 同上
	4. 应用统计导出
		1. 应用安装人次导出report/export_device_install_app_statistics
			1. 同上
		2. 应用使用数据导出report/export_device_install_app_statistics
			1. 同上
		3. 单应用使用趋势导出expanded/active_data/app/trend/export
			1. 同用户活跃导出
		4. 单应用用户使用对比导出expanded/active_data/app/user/compare/export
			1. 同用户活跃导出
	5. 网络统计导出report/export_devices
		1. 同上
	6. 敏感词统计导出
		1. 敏感词使用排名eport/export_sensitive_statistics
			1. 同上
		2. 用户使用排名report/export_sensitive_statistics
			1. 同上
	7. 流量统计导出/report/export_device_traffic_statistics
		1. 同上

应用管理
1. 应用管理
	1. 单应用版本分布安装详情导出 depmon/versions/get_install_infos_export
		1. 同活跃用户列表导出  poi response
	2. 单应用统计报表部署统计明细导出depmon/app_statisticss/20210818154959684713/single_app_download_install_by_time_range_export
		1. 同活跃用户列表导出 poi response， es
	3. 单应用统计报表运行统计明细导出/run_monitor/export/app_stats_indicators_trend_for_detail
		1. 同活跃用户列表导出  poi response
	4. 部署统计列表导出/depmon/versions/get_install_infos_export
		1. 同活跃用户列表导出  poi response
	5. 运行统计列表导出/runmon/run_monitor/export/apps_stats_indicators
		1. 同同活跃用户列表导出  poi response
	6. 活跃用户列表导出/appmanage/app/active_user/export   poi
		1. 构造参数
		2. 创建文件流
		3. 将文件写入response
	7. 活跃用户明细导出 /appmanage/app/active_user/export  poi
		1. 同上  

运维
1. 监控管理，告警事件
	1. 告警事件导出cds/event/export
		1. poi，response， es
2. 监控管理，事件统计
	1. 事件统计导出cds/event/detail_list/export
		1. poi，response， es
3. 租户日志管理
	1. 租户日志导出/cds/tenant/export_log
		1. es，  file， zip， mysql



总结:
1. 涉及到的系统有mdm，expand， cds， appmanage
2. 设计到的逻辑
	1. 样式展示
		1. 使用jasper， jasper模板文件
		2. 使用poi， excel模板文件
	2. 数据来源
		1. mysql
		2. es
	3. 通用过程
		1. 下载页面下载方式： mdm和expand服务
			1.  配置参数
			2. 创建任务
			3. 执行任务
				1. 根据reportType构造导出文件名称
				2. 创建任务对象
				3. 执行导出
					1. 根据reportType执行不同的逻辑
					2. 查询es或mysql数据库，获取数据
					3. 根据参数获取数据并构造JRDataSource导出数据为文件/ 使用poi的方式创建文件
				4. 设置状态并保存任务对象
		2. 直接返回  appmanage和cds服务
			1. 配置参数
			2. 查询数据
			3. 使用poi的方式创建文件
			4. 将文件写入response
3. 设计
	1. 如何定义导出任务
	2. 执行导出任务
	3. 定期执行等
	4. 模块关系图

1. 任务
	1. Schedule 时间， 同步异步
	2. 任务，触发器，调度器
2. https://www.cnblogs.com/makemylife/p/15838776.html


1. 管理员 -> 管辖机构（数据角色），菜单角色（菜单的查看角色）-> 展示单元列表
2. 展示单元（系统，菜单（可选），

1. 步骤
	1. 满足现有的功能
		1. 点击导出
		2. web展示
	2. 报表系统
		1. 定义报表导出接口
			1.  所属系统（对应的是xxxx://xxx.xxx.xxx.xxx:xxxx）
			2. 报表名称
			3. 所属菜单（对应的是权限中的菜单，确保管理员有权限导出该报表）
			4. 访问路径及参数(假设都是get接口）
			5. 参数（假设都是json格式）
			6. 返回（假设都是json格式）
			7. 定义返回的json字段和excel列名的对应关系
		2. 系统表
			1. 系统id，系统名称，系统schema，访问路径
		3. 报表导出配置表
			1. 配置id，配置名称，配置code，所属系统，所属菜单， jasper文件
			2. 导出需要配置成按钮，否则无法对应？？
		4. 任务表
			1. 任务id，所属系统，层级代码， 所属菜单，任务名称，文件名称， 时间，执行状态，文件uuid
		5. 导出文件名称
			1. 配置code，时间范围，层级代码，文件名称
		6. 交互
			1. 通过kafka，来传递信息