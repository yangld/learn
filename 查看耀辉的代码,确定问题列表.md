耀辉, 有两个问题, 需要确定一下
1. 接收kafka的数据来源 kafka.listen.topics=pekall_syslog_output_kafka_1,associ-analysis-cmc-device-register-log,associ-analysis-cmc-app-use-log,associ-analysis-cmc-res-visit-log, 这些topic的数据来源是哪, 是mdm,还是cmc? 我看现有的环境中kafka中都没有数据,或者数据结构是什么样的?
	1. 从cmc_association_analysis中的model, 对比cmc,是在cmc中产生的,
	2. 修改代码, 发送到对应的kafka
		1. CmcBehaviorLogAspect 会发送kafka消息, 不需要增加代码
		2.     behaviorLogTopic[CmcEsAppUsageLog]: associ-analysis-cmc-app-use-log
			  behaviorLogTopic[CmcEsDeviceRegisterLog]: associ-analysis-cmc-device-register-log
			  behaviorLogTopic[MdmResVisitLog]: associ-analysis-cmc-res-visit-log
		3. 剩下的两个看代码逻辑,待确认
			1. CmcEsUserLoginLog  associ-analysis-cmc-user-login-log  增加
			2. 
2. 输出的kafka的topic,默认是associ-analysis-cmc-event , 看cmc的web端, 最终查询的mysql的associ_analysis_event 表,  是有地方将kafka中的数据转化为mysql, 确认下在哪转换的?
	1. 接收的是cmc的KafkaConsumer, 代码备覆盖了, 恢复代码
3. pekall_syslog_output_kafka_1 的来源是什么??????
4. /resservice/{resServiceId}/logs  资源访问日志,但资源不存在的时候,直接忽略,没有到存储的时候, 故不会生成记录


5. web端的开关,当打开时,才会处理kafka中的数据,不打开则忽略数据
6. PreprocessMapFunction会把kafka中的数据,转化为四元组,dataType, dataContent, timestamp, logId
7. AssociationAnalyzeFlatMapFunction
	1. 根据dataType找到analyzer
	2. 执行analyze
		1. conent转化为eventlog
		2. eventlog转化为具体的日志, 然后业务逻辑判断,如果不正确,则返回空对象
		3. 后续生成事件日志
8. 涉及到的数据库表, 都涉及到data_type
	1. data_type_mapping                kafka的topic和data_type
	2. associ_analysis_rule_group   web端的开关表
	3. associ_analysis_rule  
	4. associ_analysis_event   web端查询逻辑,会查询这个表
9. 分析类
![[Pasted image 20221205155539.png]]