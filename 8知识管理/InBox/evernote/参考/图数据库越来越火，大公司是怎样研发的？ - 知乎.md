
# 图数据库越来越火，大公司是怎样研发的？

[![[v2-e7779955cead7d7189ed36abb9391fa0_l.jpg]]](https://www.zhihu.com/org/archsummit)

[ArchSummit](https://www.zhihu.com/org/archsummit)

和国内外上千名架构师一起聊聊架构吧！

随着人工智能技术的发展，市场对于性能的要求越来越高，然而光靠硬件的升级已经无法完全满足使用者的需求，图数据库（Graph Database）的出现，在很大程度上解决了性能的问题。

图数据库和传统的关系型数据库比较，就是图和表的差别。图数据库是用点和边来表达数据之间的关系，是更自然的存储方式，更专注于对象之间的关联。传统的关系型数据库，在记录交易的场景更有优势。

2018 年下半年，百度、阿里都已推出了自己的图数据库。在 2018 年 7 月深圳 ArchSummit 架构师峰会上，百度数据库资深架构师李玉明介绍过图数据库的技术挑战。从下面这张图标能看出来，图数据库是近 5 年来发展最快的数据库类型。

![[v2-87b3cca56407ed3a6c43f64b2b756706_720w.jpg]]

实际上，在 AI、大数据、云计算时代，人类的生活生产数据之间的关联更紧密而复杂。例如网上购物、社交、智能穿戴，以及金融安全等等。关联与分析，知识与推理，关联与搜索推荐，无处不在的图（关联），奠定了图数据库发展和广泛使用的基础。

![[v2-589a2fc3f73da345e901f57601a1cd0e_720w.jpg]]

![[v2-f68a0e5844cc44aab790d5bb20ca4725_720w.jpg]]

**那么图数据库在处理数据模型和查询过程中有哪些技术挑战呢？**

首先是图数据库的查找是随机访问，跳跃式查找，空间局部性较差。遍历时，每一跳都是一次随机访问。

其次是数据量非常大：亿级甚至千亿级的数据规模。

另外是分布式扩展，图数据的分片是个挑战，类似在 K-V 或者 document 存储中的 Hash 分片方式可能不适用，由于图数据的高度关联可能产出跨节点访问导致查询性能差；因此，切图的算法需要定制，考虑节点数量切分和边的切割两方面的平衡（Edge Cut vs Vertex Cut）

最后是图数据库图遍历的指数级节点膨胀，据统计，微信用户平均 194 个好友（2016 年），3 层遍历有：194 + 194 \* 194 + 194 \* 194 \* 194 = 7339214，搜索起来很耗时，所以需要做很多的遍历 / 剪枝等算法优化。

**图数据库技术发展火热**

开源系统领域，Neo4j 单机版已经开源，Neo4j 采用专有的 Cypher 查询语言；OrientDB 是分布式多模型数据库，支持图数据模型，支持 sharding 机制，大规模查询情况下性能比较好；Titan/JanusGraph 使用 NoSQL (如 Cassandra+ES) 来构建图数据库，用 Cassandra 来存储图片，用 Elasticsearch/Solr 构建索引引擎。

云厂商也发布了相关的图数据库：例如亚马逊（AWS）在 2017 年发布 Neptune 图数据库，支持 Gremlin 和 SPARQL；微软（Azure）发布的 Cosmos 支持图数据模型和 Gremlin 语言。

**大公司是怎么做图数据库的呢？**

![[v2-93272904a62e670e01e8d2e9c59728d5_720w.jpg]]

这是将图数据和索引结合起来同步进程的**百度图数据库系统架构**（如上图）。查询 API 会解析查询 Gremlin 的语法，转化到处理引擎，同时也会做一些用户的认证、鉴权和限流的工作。通过另外一个模块实现写入，查询模块和写入模块是分离的，在大规模分布式图数据库情况下需要对图进行切分，对相应的节点、分片、机器保存下来，以便找到 ID 服务（IDServer），ID 数据存储在 Redis 里面。除了核心在线能力之外，还有一个灌库工具，会把离线数据转换成内部存储所需的格式，供线上存储引擎使用。

![[v2-454ff355a4270f8cb17a397c5d973407_720w.jpg]]

如何将系统架构部署为高可用的架构呢？（如上图）图数据库是可以接收和处理数据，且可以查询的数据库，在 ToB 私有化场景下的处理方式是，将灌库集群里的离线数据转换成图数据库所要求的全站在线数据形式，用以查询。应用程序可以通过 API 接口写入在线集群，也满足查询需求。Redis 集群用于存储 ID 数据。

**相关推荐：**

在7月12日深圳 ArchSummit 全球架构师峰会上，阿里存储技术事业部高级技术专家 王若（花名：百润）老师将介绍当前备受关注的图数据库技术，**介绍阿里巴巴图数据库 GraphDB 的设计与实践。**

GDB（Graph Database）是阿里云 Cloud-Native 的图数据库，旨在为用户提供可靠、在线图数据库服务。演讲主要围绕 GDB 在阿里巴巴集团内部的初始设计，上云架构，应用场景和未来发展等展开讨论。同时也解密阿里巴巴如何将先进内部产品转化为云上产品，服务更广大的客户群体。

**提纲：**

1\. Tair 和 TairGraph 图服务的演进、

2\. GDB 图数据库的设计、

3\. 图数据库的应用场景和实践、

4\. GDB 的发展和生态

![[v2-99fc8f86a17e60ea6ea8f41a4544e673_720w.jpg]]

7月12日，ArchSummit 全球架构师峰会日程已发布，大会官网：【ArchSummit全球架构师峰会】。**目前9折报名最后一周，购票可以联系票务经理 灰灰 17326843116**

发布于 2019-06-19

[图数据库](https://www.zhihu.com/topic/20082499)

    Created at: 2021-01-29T18:04:32+08:00
    Updated at: 2021-01-29T18:04:32+08:00

