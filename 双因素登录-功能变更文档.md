## web
1. 运营web无需修改, 增加的证书服务由服务端脚本提供,部署的时候执行脚本,添加证书服务
2. 统一认证
	1. uas, 去掉系统设置中的APP端认证设置

## app

## server
1. 运营, 增加证书服务的脚本

http://192.168.11.34/index.php?m=story&f=view&storyID=493

支持认证和声纹的租户级配置---------支持
支持多种认证和声纹的配置-------支持
双因素认证, 需要服务端保证, 设计文档体现---------over

与玉强再次确认一下, 证书内容是否在uas中有留存------没有留存---------over

客户端要有声纹注销的功能
	关闭及注销------原型没有注销的图, 文档中有说明------------------------
培育和张乐,明确改动内容
	培育客户端需要进行哪些变更工作
	web端, 证书和声纹信息管理页面, 需要有, 明确一下web端的样子, 变更内容

运营中,暂时只支持开启和关闭声纹, 声纹使用哪个厂商, 有客户端登录时传递的参数vendor确定
706项目中, 运营中必须添加证书认证和声纹认证的服务, 创建租户时,必须选择声纹认证和证书认证


## 现有逻辑
1. 运营中, 有声纹认证服务, 只有一个服务,一个功能
	1. 后续,需要修改功能code, 不同的厂家,对应不同的code
	2. 声纹的注册和验证, 都和这个code有关,对应不同的逻辑
	3. 切换声纹厂商,会将历史中的声纹都清除, 需谨慎操作
2. 运营中,没有证书认证服务
	1. 需要增加证书认证服务, 不同的厂商,对应不同的功能code
	2. 切换厂商,会清除历史中的证书, 需谨慎操作
	3. 证书的注册和验证,都和这个code有关,对应不同的逻辑
	4. 需要再部署脚本中, 增加该服务的添加脚本
	5. 当开启了证书认证,则支持证书的双因素认证, 主登录之后,进行证书的双因素认证
	6. 是否会与已有的双因素认证冲突, 还是只是绑定声纹认证
3. 双因素认证原理
	1. 证书认证,需要增加一个loginType为Cert, vendor为xxx的类, 参考SuresecCertLoginMechanism, 主要是修改login逻辑, Cert是支持作为主认证的
	2. 在证书认证的时候, 传递loginType,vendor
	3. 声纹认证,需要增加一个loginType为VPL, vendor为xxx的类, 参考VplLoginMechanism
4. 登录有几件事要做
	1. 会话管理,将会话信息,写入session中
	2. 按不同的方式,验证用户是否登录成功
	3. 判断用户是否锁定, 锁定和解锁

1. 变动内容
	1. web
		1. uas, 去掉系统设置中的APP端认证设置,默认开启, 主认证设置: 证书认证, 双因素认证设置: 声纹认证, 口令认证
		2. 部署op后, 增加声纹认证和证书认证服务
		3. 创建租户时,需要开启声纹认证和证书认证
	2. server
		1. 增加新的证书认证逻辑(新类)
		2. 增加新的声纹认证逻辑(新类)
		3. 增加新的声纹申请逻辑(新类)
		4. 统一认证, APP端认证设置的默认数据, 使用脚本更新
	3. app
		1. 样式不需要修改
		2. 首次登录
			1. 增加证书授权码的显示
			2. 增加根据用户名,授权码申请证书的逻辑,直接调用证书服务器,申请完证书,保存证书到本地
			3. 先进行证书认证(双因素)
			4. 然后进行口令认证(双因素)
		3. 声纹认证
			1. 先进行证书认证(双因素)
			2. 然后进行声纹认证(双因素)
		4. 声纹申请
			1. 获取的文本是一个
			2. 只上传一次文件
		5. 声纹注销
			1. 

1. 原型说明文档, 修改一下----------over
2. 增加功能变更列表, 提供给App,Web,Server, 供开发使用-------over





![[6541674034026_.pic.jpg]]